---
import BaseLayout from "../../components/BaseLayout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("diary");
  return entries.map((entry) => ({
    params: { slug: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

const formattedDate = entry.data.date.toLocaleDateString("en-US", {
  year: "numeric",
  month: "long",
});
---

<BaseLayout
  title={`${entry.data.title} - Dipankar Das`}
  description={entry.data.description}
>
  <article class="animate-fade-in">
    <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <a
        href="/diary/"
        class="text-sm text-app-accent hover:text-app-accent-hover transition-colors"
      >
        &larr; Back to diary
      </a>
      <time class="block mt-6 text-sm font-medium text-app-gray uppercase tracking-wider">
        {formattedDate}
      </time>
      <h1 class="mt-3 text-3xl md:text-[44px] font-bold text-app-text leading-tight">
        {entry.data.title}
      </h1>

      <div class="mt-10 prose prose-lg max-w-none">
        <Content />
      </div>

      <div class="mt-12 pt-6 border-t border-app-border">
        <a
          href="/diary/"
          class="text-sm text-app-accent hover:text-app-accent-hover transition-colors"
        >
          &larr; Back to diary
        </a>
      </div>
    </div>
  </article>
</BaseLayout>
